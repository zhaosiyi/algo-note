<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>Blog</title>
    <link rel="stylesheet" href="../../css/materialize.min.css" charset="UTF-8">
    <link rel="stylesheet" href="../../css/prism.css" charset="UTF-8">
    <link rel="stylesheet" href="../../css/article.css" charset="UTF-8">
</head>
<body>
<header class="blue darken-2 white-text z-depth-1">
    <span id="home"><a class="white-text" href="../../index.html">Zhaosiyi's Blog</a></span>
</header>
<div id="main" class="row">
<div id="content" class="col m7 s12">
    <h1 id="main-title">求素数的线性筛法</h1>
    <div>
        <span>创建日期：2016-10-23</span>
    </div>
    <div class="heading-high scrollspy"><h2>代码</h1><div class="divider"></div></div>
<p>执行完函数 f() 后，数组 ans 中将存储 [1, end] 范围内的素数，也可以直接用 not_prime 数组判断。</p>
<pre class="line-numbers"><code class="language-cpp">// 需包含 &lt;vector&gt; 和 &lt;bitset&gt;
const int maxn= 10000005;
bitset&lt;maxn&gt; not_prime;
vector&lt;int&gt; ans; 
 
void f(int end){
    not_prime.set(1); // 1 不是素数。
    for(int i=2; i&lt;=end; ++i){
        if(!not_prime[i]) ans.push_back(i); // 未被筛去的数一定是素数。
        for(int j=0, s=ans.size(); j&lt;s &amp;&amp; (long long)i*ans[j]&lt;end; ++j){
            not_prime.set(i*ans[j]); // 素数的倍数一定是合数。
            if(i%ans[j]==0) break; // 及时退出循环防止重复筛数。
        }
    }
}
</code></pre>
<div class="heading-high scrollspy"><h2>习题</h1><div class="divider"></div></div>
可以到<a href="https://www.luogu.org/problem/show?pid=3383">这里</a>测试程序。代码如下：
<pre class="line-numbers"><code class="language-cpp">#include &lt;cstdio&gt;
#include &lt;vector&gt;
#include &lt;bitset&gt;
using namespace std;
 
const int maxn= 10000005;
bitset&lt;maxn&gt; not_prime;
vector&lt;int&gt; ans; 
 
void f(int end){
    not_prime.set(1);
    for(int i=2; i&lt;=end; ++i){
        if(!not_prime[i]) ans.push_back(i);
        for(int j=0, s=ans.size(); j&lt;s &amp;&amp; (long long)i*ans[j]&lt;=end; ++j){
            not_prime.set(i*ans[j]);
            if(i%ans[j]==0) break;
        }
    }
}
 
int main(){
 
    int range, size;
 
    scanf("%d%d", &amp;range, &amp;size);
 
    f(range);
 
    for(int i=0; i&lt;size; ++i){
        int n;
        if(1!=scanf("%d", &amp;n)) break;
        if(not_prime[n]) printf("No\n");
        else printf("Yes\n");
    }
 
    return 0;
}
</code></pre>

    <hr>
    <span>End.</span>
</div>
<div id="directory" class="col m5 hide-on-small-only"></div>
</div>
<script src="../../js/jquery-3.0.0.min.js"></script>
<script src="../../js/materialize.min.js"></script>
<script src="../../js/prism.js"></script>
<script src="../../js/article.js"></script>

</body>
</html>